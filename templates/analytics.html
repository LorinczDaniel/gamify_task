<!-- Google tag (gtag.js) -->
{% set measurement_id = config.get('GA_MEASUREMENT_ID') or 'G-7XBMCRC1YC' %}
{% if measurement_id %}
<script async src="https://www.googletagmanager.com/gtag/js?id={{ measurement_id }}"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '{{ measurement_id }}', {
    'send_page_view': true,
    'anonymize_ip': true  // GDPR compliance
  });
  
  // Helper function to track custom events
  window.trackEvent = function(eventName, eventParams) {
    if (typeof gtag !== 'undefined') {
      gtag('event', eventName, eventParams);
    }
  };
</script>
{% endif %}

